# Дз3

**Количесто записей для запроса подписано только там где невозможно уместить на скриншот!**

1. Вывести распределение (количество) клиентов по сферам деятельности, отсортировав результат по убыванию количества. — `(1 балл)`

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/b86d1406-7ea5-45a0-9c67-770740a1d7c8)

2. Найти сумму транзакций за каждый месяц по сферам деятельности, отсортировав по месяцам и по сфере деятельности. — `(1 балл)`<br>`120 Записей`</br>

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/c755a158-5473-44db-b64d-3da05d95c9b7)

3. Вывести количество онлайн-заказов для всех брендов в рамках подтвержденных заказов клиентов из сферы IT. — `(1 балл)`

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/600ec071-ea73-4a13-b66c-9d96d587e8ce)

4. Найти по всем клиентам сумму всех транзакций (list_price), максимум, минимум и количество транзакций, отсортировав результат по убыванию суммы транзакций и количества клиентов. 
Выполните двумя способами: используя только group by и используя только оконные функции. Сравните результат. — `(2 балла)`

- GROUP BY<br>`3 494 Записи`</br>

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/761ab03a-d21b-4e57-8e60-25cb8b05d58d)

- Оконные функции<br>`3 494 Записи`</br>

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/788d508f-2882-4d84-8d43-3ecee041d5c4)

5. Найти имена и фамилии клиентов с минимальной/максимальной суммой транзакций за весь период (сумма транзакций не может быть null). 
Напишите отдельные запросы для минимальной и максимальной суммы. — `(2 балла)`

- MIN

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/f4efb678-91c0-4f82-92a1-0de411434ab8)

- MAX

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/54d93429-081e-4bb3-b238-90299ad9bae2)

6. Вывести только самые первые транзакции клиентов. Решить с помощью оконных функций. — `(1 балл)`

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/b92fb7bc-c5ef-48f5-9cda-0157a3ff48e0)

7. Вывести имена, фамилии и профессии клиентов, между транзакциями которых был максимальный интервал (интервал вычисляется в днях) — `(2 балла)`.

![image](https://github.com/mllightitup/sf_data_science/assets/43480503/954be26b-e383-451e-b82b-0d89d5aac595)
